<!DOCTYPE html>
<html>
<head>
    <title>RenVault Analytics</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .stats { display: flex; gap: 20px; margin-bottom: 30px; }
        .stat-card { background: #f5f5f5; padding: 20px; border-radius: 8px; }
        .chart-container { width: 100%; height: 400px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>RenVault Protocol Analytics</h1>
    
    <div class="stats" id="stats"></div>
    
    <div class="chart-container">
        <canvas id="depositsChart"></canvas>
    </div>

    <script>
        async function loadStats() {
            const response = await fetch('/api/stats');
            const stats = await response.json();
            
            document.getElementById('stats').innerHTML = `
                <div class="stat-card">
                    <h3>Total Deposits</h3>
                    <p>${stats.totalDeposits.toLocaleString()} STX</p>
                </div>
                <div class="stat-card">
                    <h3>Total Users</h3>
                    <p>${stats.totalUsers}</p>
                </div>
                <div class="stat-card">
                    <h3>Total Fees</h3>
                    <p>${stats.totalFees.toLocaleString()} STX</p>
                </div>
            `;
        }

        async function loadChart() {
            const response = await fetch('/api/timeseries');
            const data = await response.json();
            
            const ctx = document.getElementById('depositsChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Object.keys(data),
                    datasets: [{
                        label: 'Daily Deposits',
                        data: Object.values(data),
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                }
            });
        }

        loadStats();
        loadChart();
        setInterval(loadStats, 30000);
    </script>
</body>
</html>